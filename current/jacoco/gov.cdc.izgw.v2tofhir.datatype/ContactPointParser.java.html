<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ContactPointParser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">HL7 Version 2 to FHIR Conversion</a> &gt; <a href="index.source.html" class="el_package">gov.cdc.izgw.v2tofhir.datatype</a> &gt; <span class="el_source">ContactPointParser.java</span></div><h1>ContactPointParser.java</h1><pre class="source lang-java linenums">package gov.cdc.izgw.v2tofhir.datatype;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Iterator;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.apache.commons.validator.routines.EmailValidator;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointSystem;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DateTimeType;
import org.hl7.fhir.r4.model.IntegerType;
import org.hl7.fhir.r4.model.Period;
import org.hl7.fhir.r4.model.StringType;

import ca.uhn.hl7v2.model.Composite;
import ca.uhn.hl7v2.model.Primitive;
import ca.uhn.hl7v2.model.Type;
import gov.cdc.izgw.v2tofhir.converter.DatatypeConverter;
import gov.cdc.izgw.v2tofhir.utils.ParserUtils;
import lombok.extern.slf4j.Slf4j;

/**
 * Parser that supports parsing a String, or HL7 Version into a FHIR ContactPoint.
 * 
 * @author Audacious Inquiry
 */
<span class="fc" id="L32">@Slf4j</span>
public class ContactPointParser implements DatatypeParser&lt;ContactPoint&gt; {
	static {
<span class="fc" id="L35">		log.debug(&quot;{} loaded&quot;, ContactPointParser.class.getName());</span>
	}

	static final String AREA_CODE = &quot;\\(\\s*\\d{3}\s*\\)&quot;;
	static final String COUNTRY_CODE = &quot;\\+\\s*\\d{1,3}&quot;;
	static final String PHONE_CHAR = &quot;\\-+0123456789(). []{},#&quot;;
	static final String PHONE_NUMBER = &quot;(-|\\.|\\d+)+&quot;;
	// [NN] [(999)]999-9999[X99999][B99999][C any text]
<span class="fc" id="L43">	static final Pattern TN_PATTERN = Pattern.compile(</span>
		&quot;((\\d{2,3})?(\\(\\d{3}\\))?\\d{3}-?\\d{4}(X\\d{1,5})?(B\\d1,5)?)(C.*)?$&quot;
	);
	static final String CONTACTPOINT_COMMENT = &quot;http://hl7.org/fhir/StructureDefinition/contactpoint-comment&quot;;
	
<span class="fc" id="L48">	private static final EmailValidator EMAIL_VALIDATOR = EmailValidator.getInstance();</span>
	static StringBuilder appendIfNotBlank(StringBuilder b, String prefix, String string, String suffix) {
<span class="fc bfc" id="L50" title="All 2 branches covered.">		if (StringUtils.isBlank(string)) {</span>
<span class="fc" id="L51">			return b;</span>
		}
<span class="fc" id="L53">		return b.append(StringUtils.defaultString(prefix))</span>
<span class="fc" id="L54">				.append(StringUtils.defaultString(string))</span>
<span class="fc" id="L55">				.append(StringUtils.defaultString(suffix));</span>
	}
	
	/**
	 * Construct a ContactPointParser
	 */
<span class="fc" id="L61">	public ContactPointParser() {</span>
		// Construct the default ContactPointParser
<span class="fc" id="L63">	}</span>
	
	/**
	 * Convert an HL7 V2 XTN into a list of contacts.
	 * @param xtn	The HL7 V2 xtn (or similarly shaped composite).
	 * @return	A list of ContactPoint objects from the XTN.
	 */
	public List&lt;ContactPoint&gt; convert(Composite xtn) {
<span class="fc" id="L71">		Type[] types = xtn.getComponents();</span>
<span class="fc" id="L72">		List&lt;ContactPoint&gt; cps = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L73" title="1 of 2 branches missed.">		if (types.length &gt; 0) {</span>
<span class="fc" id="L74">			cps.add(convert(types[0]));	// Convert XTN-1 to a phone number.</span>
		}
<span class="fc" id="L76">		cps.add(fromEmail(ParserUtils.toString(types, 3)));</span>
<span class="fc" id="L77">		String value = fromXTNparts(types);</span>
<span class="fc bfc" id="L78" title="All 2 branches covered.">		if (StringUtils.isNotBlank(value)) {</span>
<span class="fc" id="L79">			cps.add(new ContactPoint().setValue(value).setSystem(ContactPointSystem.PHONE));</span>
		}
<span class="fc" id="L81">		String unformatted = ParserUtils.toString(types, 11);</span>
<span class="pc bpc" id="L82" title="1 of 2 branches missed.">		if (StringUtils.isNotBlank(unformatted)) {</span>
<span class="nc" id="L83">			cps.add(new ContactPoint().setValue(unformatted).setSystem(ContactPointSystem.PHONE));</span>
		}
<span class="fc" id="L85">		String comment = ParserUtils.toString(types, 8);</span>
<span class="fc" id="L86">		String use = StringUtils.defaultIfBlank(ParserUtils.toString(types, 1), &quot;&quot;);</span>
<span class="fc" id="L87">		String type = StringUtils.defaultIfBlank(ParserUtils.toString(types, 2), &quot;&quot;);</span>
<span class="pc bpc" id="L88" title="1 of 2 branches missed.">		DateTimeType start = types.length &gt; 12 ? DatatypeConverter.toDateTimeType(types[12]) : null;</span>
<span class="pc bpc" id="L89" title="1 of 2 branches missed.">		DateTimeType end = types.length &gt; 13 ? DatatypeConverter.toDateTimeType(types[13]) : null;</span>
<span class="pc bpc" id="L90" title="1 of 2 branches missed.">		IntegerType order = types.length &gt; 17 ? DatatypeConverter.toIntegerType(types[17]) : null;</span>
		
<span class="fc" id="L92">		Period period = null;</span>
<span class="pc bpc" id="L93" title="2 of 4 branches missed.">		if (start != null || end != null) {</span>
<span class="nc" id="L94">			period = new Period().setStartElement(start).setEndElement(end);</span>
		}
		
<span class="fc" id="L97">		cleanupContactPoints(cps, comment, use, type, order, period);</span>
<span class="fc" id="L98">		return cps;</span>
	}

	@Override
	public Type convert(ContactPoint type) {
		// TODO Auto-generated method stub
<span class="nc" id="L104">		return null;</span>
	}
	@Override
	public ContactPoint convert(Type type) {
		
<span class="pc bpc" id="L109" title="1 of 2 branches missed.">		if ((type = DatatypeConverter.adjustIfVaries(type)) == null) {</span>
<span class="nc" id="L110">			return null;</span>
		}
		
<span class="fc bfc" id="L113" title="All 2 branches covered.">		if (type instanceof Primitive pt) {</span>
<span class="pc bpc" id="L114" title="1 of 2 branches missed.">			if (DatatypeConverter.isDeleted(pt)) {</span>
<span class="nc" id="L115">				return DatatypeConverter.markDeleted(new ContactPoint());</span>
			}

<span class="fc" id="L118">			return fromString(ParserUtils.toString(type)); </span>
		}
		
<span class="pc bpc" id="L121" title="1 of 2 branches missed.">		if (&quot;XTN&quot;.equals(type.getName())) {</span>
<span class="fc" id="L122">			List&lt;ContactPoint&gt; cps = convert((Composite)type);</span>
<span class="pc bpc" id="L123" title="1 of 2 branches missed.">			return cps.isEmpty() ? null : cps.get(0);</span>
		}
		
<span class="nc" id="L126">		return null;</span>
	}
	
	@Override
	public ContactPoint fromString(String value) {
<span class="fc" id="L131">		ContactPoint cp = fromPhone(value);</span>
<span class="pc bpc" id="L132" title="1 of 4 branches missed.">		if (cp != null &amp;&amp; !cp.isEmpty()) {</span>
<span class="fc" id="L133">			return cp;</span>
		}
<span class="fc" id="L135">		cp = fromEmail(value);</span>
<span class="pc bpc" id="L136" title="3 of 4 branches missed.">		if (cp != null &amp;&amp; !cp.isEmpty()) {</span>
<span class="nc" id="L137">			return cp;</span>
		}
<span class="fc" id="L139">		cp = fromUrl(value);</span>
<span class="pc bpc" id="L140" title="1 of 4 branches missed.">		if (cp != null &amp;&amp; !cp.isEmpty()) {</span>
<span class="fc" id="L141">			return cp;</span>
		}
<span class="fc" id="L143">		return null;</span>
	}
	
	/**
	 * Create a ContactPoint from a string representing an e-mail address.
	 * 
	 * This method recognizes mailto: urls, and RFC-2822 email addresses
	 * @see #fromEmail(String)
	 * 
	 * @param value	The email address.
	 * @return	A ContactPoint object representing this e-mail address. 
	 */
	public static ContactPoint fromEmail(String value) {
<span class="fc bfc" id="L156" title="All 2 branches covered.">		if (StringUtils.isBlank(value)) {</span>
<span class="fc" id="L157">			return null;</span>
		}
<span class="fc" id="L159">		value = StringUtils.strip(value).split(&quot;[;,]&quot;)[0];</span>
<span class="fc" id="L160">		String name = null;</span>
<span class="fc" id="L161">		String email = null;</span>
<span class="pc bpc" id="L162" title="1 of 2 branches missed.">		if (value.contains(&quot;&lt;&quot;)) {</span>
<span class="nc" id="L163">			name = StringUtils.substringBefore(value, &quot;&lt;&quot;);</span>
<span class="nc" id="L164">			email = StringUtils.substringBetween(value, &quot;&lt;&quot;, &quot;&gt;&quot;);</span>
		} else {
<span class="fc" id="L166">			email = value; </span>
		}
<span class="pc bpc" id="L168" title="1 of 2 branches missed.">		if (StringUtils.startsWith(email, &quot;mailto:&quot;)) {</span>
<span class="nc" id="L169">			email = email.substring(7);</span>
		}
		/*
		 * Simplfied RFC-2822 grammar
		 * mailbox         = name-addr / addr-spec
		 * name-addr       = [display-name] angle-addr
		 * angle-addr      = [CFWS] &quot;&lt;&quot; addr-spec &quot;&gt;&quot; [CFWS]
		 * display-name	   = word | quoted-string
		 * addr-spec       = local-part &quot;@&quot; domain
		 * local-part      = dot-atom / quoted-string / obs-local-part
		 * domain          = dot-atom / domain-literal / obs-domain
		 * domain-literal  = [CFWS] &quot;[&quot; *([FWS] dcontent) [FWS] &quot;]&quot; [CFWS]
		 * dcontent        = dtext / quoted-pair
		 * dtext           = NO-WS-CTL /     ; Non white space controls
	     *                   %d33-90 /       ; The rest of the US-ASCII
	     *                   %d94-126        ;  characters not including &quot;[&quot;, &quot;]&quot;, or &quot;\&quot;
		 */
<span class="pc bpc" id="L186" title="1 of 2 branches missed.">		if (EMAIL_VALIDATOR.isValid(email)) {</span>
<span class="nc" id="L187">			ContactPoint cp = new ContactPoint();</span>
<span class="nc" id="L188">			cp.setSystem(ContactPointSystem.EMAIL);</span>
<span class="nc" id="L189">			cp.setValue(email);</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">			if (StringUtils.isNotBlank(name)) {</span>
<span class="nc" id="L191">				cp.addExtension()</span>
<span class="nc" id="L192">					.setUrl(CONTACTPOINT_COMMENT)</span>
<span class="nc" id="L193">					.setValue(new StringType(name));</span>
			}
<span class="nc" id="L195">			return cp;</span>
		}
<span class="fc" id="L197">		return null;</span>
	}
	
	/**
	 * Create a list of ContactPoints 
	 * @param values	A string providing the list of email addresses, separated by semi-colons, commas, or newlines.
	 * @return	The list of contact points.
	 */
	public static List&lt;ContactPoint&gt; fromEmails(String values) {
<span class="nc bnc" id="L206" title="All 2 branches missed.">		if (StringUtils.isBlank(values)) {</span>
<span class="nc" id="L207">			return Collections.emptyList();</span>
		}
<span class="nc" id="L209">		List&lt;ContactPoint&gt; cps = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L210" title="All 2 branches missed.">		for (String value: StringUtils.strip(values).split(&quot;[;,\n\r]+&quot;)) {</span>
<span class="nc" id="L211">			ContactPoint cp = fromEmail(value);</span>
<span class="nc bnc" id="L212" title="All 4 branches missed.">			if (cp != null &amp;&amp; !cp.isEmpty()) {</span>
<span class="nc" id="L213">				cps.add(cp);</span>
			}
		}
<span class="nc" id="L216">		return cps;</span>
	}

	/**
	 * Create a ContactPoint from a string representing a phone number.
	 * 
	 * This method recognizes tel: urls and other strings containing phone dialing
	 * characters and punctuation.
	 * 
	 * @param value	The phone number.
	 * @return	A ContactPoint object representing the phone number. 
	 */
	public static ContactPoint fromPhone(String value) {
<span class="fc bfc" id="L229" title="All 2 branches covered.">		if (StringUtils.isBlank(value)) {</span>
<span class="fc" id="L230">			return null;</span>
		}
<span class="fc" id="L232">		ContactPoint cp = null;</span>
<span class="fc" id="L233">		value = StringUtils.strip(value);</span>
<span class="pc bpc" id="L234" title="1 of 2 branches missed.">		if (value.startsWith(&quot;tel:&quot;)) {</span>
<span class="nc" id="L235">			return new ContactPoint().setValue(value.substring(4)).setSystem(ContactPointSystem.PHONE);</span>
		}
<span class="pc bpc" id="L237" title="1 of 2 branches missed.">		if (value.startsWith(&quot;fax:&quot;)) {</span>
<span class="nc" id="L238">			return new ContactPoint().setValue(value.substring(4)).setSystem(ContactPointSystem.FAX);</span>
		}
<span class="pc bpc" id="L240" title="1 of 2 branches missed.">		if (value.startsWith(&quot;sms:&quot;)) {</span>
<span class="nc" id="L241">			return new ContactPoint().setValue(value.substring(4)).setSystem(ContactPointSystem.SMS);</span>
		}
		
<span class="fc" id="L244">		Matcher m = TN_PATTERN.matcher(value);</span>
<span class="fc bfc" id="L245" title="All 2 branches covered.">		if (m.matches()) {</span>
<span class="fc" id="L246">			cp = new ContactPoint();</span>
			// Could be fax or pager or SMS or other but we won't know without context.
<span class="fc" id="L248">			cp.setSystem(ContactPointSystem.PHONE);</span>
<span class="fc" id="L249">			cp.setValue(m.group(1));</span>
<span class="fc" id="L250">			String comment = StringUtils.substringAfter(value, &quot;C&quot;);</span>
<span class="pc bpc" id="L251" title="1 of 2 branches missed.">			if (StringUtils.isNotBlank(comment)) {</span>
<span class="nc" id="L252">				cp.addExtension()</span>
<span class="nc" id="L253">					.setUrl(CONTACTPOINT_COMMENT)</span>
<span class="nc" id="L254">					.setValue(new StringType(comment));</span>
			}
<span class="fc" id="L256">			return cp;</span>
		}
<span class="pc bpc" id="L258" title="1 of 2 branches missed.">		if (StringUtils.containsOnly(value, PHONE_CHAR) ||</span>
<span class="pc bpc" id="L259" title="3 of 6 branches missed.">			value.matches(COUNTRY_CODE) || value.matches(AREA_CODE) || value.matches(PHONE_NUMBER)</span>
		) {
<span class="nc" id="L261">			cp = new ContactPoint();</span>
<span class="nc" id="L262">			cp.setSystem(ContactPointSystem.PHONE);</span>
<span class="nc" id="L263">			cp.setValue(value.replace(&quot; &quot;, &quot;&quot;));</span>
<span class="nc" id="L264">			return cp;</span>
		}
<span class="fc" id="L266">		return null;</span>
	}
	
	/**
	 * Create a ContactPoint from a URL
	 * @param url The URL to convert to a contact point
	 * @return A ContactPoint object representing the URL.
	 */
	public static ContactPoint fromUrl(String url) {
<span class="fc" id="L275">		url = StringUtils.strip(url);</span>
<span class="fc bfc" id="L276" title="All 2 branches covered.">		if (StringUtils.isEmpty(url)) {</span>
<span class="fc" id="L277">			return null;</span>
		}
<span class="fc" id="L279">		String scheme = StringUtils.substringBefore(url, &quot;:&quot;);</span>
<span class="fc" id="L280">		ContactPointSystem system = ContactPointSystem.URL;</span>
<span class="pc bpc" id="L281" title="1 of 2 branches missed.">		if (StringUtils.isNotEmpty(scheme)) {</span>
<span class="pc bpc" id="L282" title="1 of 2 branches missed.">			if (&quot;mailto&quot;.equalsIgnoreCase(scheme))</span>
<span class="nc" id="L283">				system = ContactPointSystem.EMAIL;</span>
<span class="pc bpc" id="L284" title="1 of 2 branches missed.">			else if (&quot;tel&quot;.equalsIgnoreCase(scheme))</span>
<span class="nc" id="L285">				system = ContactPointSystem.PHONE;</span>
<span class="pc bpc" id="L286" title="1 of 2 branches missed.">			else if (&quot;fax&quot;.equalsIgnoreCase(scheme))</span>
<span class="nc" id="L287">				system = ContactPointSystem.FAX;</span>
<span class="pc bpc" id="L288" title="1 of 2 branches missed.">			else if (&quot;sms&quot;.equalsIgnoreCase(scheme))</span>
<span class="nc" id="L289">				system = ContactPointSystem.SMS;</span>
<span class="fc" id="L290">			return new ContactPoint()</span>
<span class="fc" id="L291">					.setValue(url)</span>
<span class="fc" id="L292">					.setSystem(system);</span>
		}
<span class="nc bnc" id="L294" title="All 2 branches missed.">		if (url.matches(&quot;^([\\-a-zA-Z0-9]+|\\d{1,3})([.\\-a-zA-Z0-9]+|\\d{1,3})+(/.*)?$&quot;)) {</span>
<span class="nc bnc" id="L295" title="All 4 branches missed.">			if (url.startsWith(&quot;www&quot;) || url.contains(&quot;/&quot;)) {</span>
<span class="nc" id="L296">				url = &quot;http://&quot; + url;</span>
<span class="nc" id="L297">				system = ContactPointSystem.URL;</span>
			} else {
<span class="nc" id="L299">				system = ContactPointSystem.OTHER;</span>
			}
<span class="nc" id="L301">			return new ContactPoint()</span>
<span class="nc" id="L302">					.setValue(url)</span>
<span class="nc" id="L303">					.setSystem(system);</span>
		}
<span class="nc" id="L305">		return null;</span>
	}
	
	@Override
	public Class&lt;? extends ContactPoint&gt; type() {
<span class="nc" id="L310">		return ContactPoint.class;</span>
	}
	
	private static void cleanupContactPoints(List&lt;ContactPoint&gt; cps, String comment, String use, String type,
			IntegerType order, Period period) {
		// Cleanup list after parsing.
<span class="fc" id="L316">		Iterator&lt;ContactPoint&gt; it = cps.iterator();</span>
<span class="fc bfc" id="L317" title="All 2 branches covered.">		while (it.hasNext()) {</span>
<span class="fc" id="L318">			ContactPoint cp = it.next();</span>
<span class="pc bpc" id="L319" title="2 of 6 branches missed.">			if (cp == null || cp.isEmpty() || StringUtils.isBlank(cp.getValue())) {</span>
<span class="fc" id="L320">				it.remove();</span>
<span class="fc" id="L321">				continue;</span>
			}
<span class="pc bpc" id="L323" title="1 of 2 branches missed.">			if (StringUtils.isNotBlank(comment)) {</span>
<span class="nc" id="L324">				cp.addExtension()</span>
<span class="nc" id="L325">					.setUrl(CONTACTPOINT_COMMENT)</span>
<span class="nc" id="L326">					.setValue(new StringType(comment));</span>
			}
<span class="fc" id="L328">			mapUseCode(use, cp);</span>
<span class="fc" id="L329">			mapTypeCode(type, cp);</span>
<span class="pc bpc" id="L330" title="3 of 4 branches missed.">			if (period != null &amp;&amp; !period.isEmpty()) {</span>
<span class="nc" id="L331">				cp.setPeriod(period);</span>
			}
<span class="pc bpc" id="L333" title="3 of 4 branches missed.">			if (order != null &amp;&amp; !order.isEmpty()) {</span>
<span class="nc" id="L334">				cp.setRank(order.getValue());</span>
			}
<span class="fc" id="L336">		}</span>
<span class="fc" id="L337">	}</span>
	
	/**
	 * Create a phone number as a String from the components of XTN datatype.
	 * @param types	The components of the XTN datatype
	 * @return	The phone number as a string.
	 */
	public static String fromXTNparts(Type[] types) {
<span class="fc" id="L345">		String country = ParserUtils.toString(types, 4);</span>
<span class="fc" id="L346">		String area = ParserUtils.toString(types, 5);</span>
<span class="fc" id="L347">		String local = ParserUtils.toString(types, 6);</span>
<span class="fc" id="L348">		String extension  = ParserUtils.toString(types, 7);</span>
<span class="fc" id="L349">		String extPrefix = ParserUtils.toString(types, 9);</span>
		
<span class="fc bfc" id="L351" title="All 2 branches covered.">		if (!StringUtils.isAllBlank(country, area, local, extension)) {</span>
<span class="fc" id="L352">			StringBuilder b = new StringBuilder();</span>
<span class="fc" id="L353">			appendIfNotBlank(b, &quot;+&quot;, country, &quot; &quot;);</span>
<span class="fc" id="L354">			appendIfNotBlank(b, &quot;(&quot;, area, &quot;) &quot;);</span>
<span class="fc" id="L355">			appendIfNotBlank(b, null, local, null);</span>
<span class="fc" id="L356">			appendIfNotBlank(b, StringUtils.defaultIfBlank(extPrefix, &quot;#&quot;), extension, null);</span>
<span class="fc" id="L357">			return b.toString();</span>
		}
<span class="fc" id="L359">		return null;</span>
	}
	
	private static void mapTypeCode(String type, ContactPoint cp) {
<span class="pc bpc" id="L363" title="7 of 9 branches missed.">		switch (type) {</span>
<span class="nc" id="L364">		case &quot;BP&quot;: cp.setSystem(ContactPointSystem.PAGER); break;</span>
		case &quot;CP&quot;: 
<span class="nc" id="L366">			cp.setSystem(ContactPointSystem.PHONE);</span>
<span class="nc" id="L367">			cp.setUse(ContactPointUse.MOBILE);</span>
<span class="nc" id="L368">			break;</span>
<span class="nc" id="L369">		case &quot;FX&quot;: cp.setSystem(ContactPointSystem.FAX); break;</span>
<span class="nc" id="L370">		case &quot;Internet&quot;: cp.setSystem(ContactPointSystem.URL); break;</span>
<span class="nc" id="L371">		case &quot;MD&quot;: cp.setSystem(ContactPointSystem.OTHER); break;</span>
		case &quot;PH&quot;, &quot;SAT&quot;: 
<span class="fc" id="L373">			cp.setSystem(ContactPointSystem.PHONE); break;</span>
<span class="nc" id="L374">		case &quot;TDD&quot;, &quot;TTY&quot;: cp.setSystem(ContactPointSystem.OTHER); break;</span>
<span class="nc" id="L375">		case &quot;X.400&quot;: cp.setSystem(ContactPointSystem.EMAIL); break;</span>
		default: break;
		}
<span class="fc" id="L378">	}</span>

	private static void mapUseCode(String use, ContactPoint cp) {
<span class="pc bpc" id="L381" title="2 of 4 branches missed.">		switch (use) {</span>
		case &quot;PRS&quot;: // Personal Number
<span class="nc" id="L383">			cp.setUse(ContactPointUse.MOBILE); break;</span>
		case &quot;ORN&quot;,	// Other Residence Number
			 &quot;PRN&quot;, // Primary Residence Number
			 &quot;VHN&quot;: // Vacation Home Number
<span class="fc" id="L387">			cp.setUse(ContactPointUse.HOME); break;</span>
		case &quot;WPN&quot;: // Work Number
<span class="nc" id="L389">			cp.setUse(ContactPointUse.WORK); break;</span>
		case &quot;NET&quot;, // Network (email) Address
			 &quot;ASN&quot;,	// Answering Service Number
			 &quot;BPN&quot;,	// Beeper Number
			 &quot;EMR&quot;: // Emergency Number
		default: break;
		}
<span class="fc" id="L396">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>