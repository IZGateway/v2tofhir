<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PIDParser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">HL7 Version 2 to FHIR Conversion</a> &gt; <a href="index.source.html" class="el_package">gov.cdc.izgw.v2tofhir.segment</a> &gt; <span class="el_source">PIDParser.java</span></div><h1>PIDParser.java</h1><pre class="source lang-java linenums">package gov.cdc.izgw.v2tofhir.segment;

import java.util.ArrayList;
import java.util.List;

import org.hl7.fhir.instance.model.api.IBaseResource;
import org.hl7.fhir.r4.model.Account;
import org.hl7.fhir.r4.model.Account.AccountStatus;
import org.hl7.fhir.r4.model.Address;
import org.hl7.fhir.r4.model.BooleanType;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DateTimeType;
import org.hl7.fhir.r4.model.Enumeration;
import org.hl7.fhir.r4.model.Enumerations.AdministrativeGender;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.HumanName;
import org.hl7.fhir.r4.model.HumanName.NameUse;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.InstantType;
import org.hl7.fhir.r4.model.IntegerType;
import org.hl7.fhir.r4.model.MessageHeader;
import org.hl7.fhir.r4.model.Patient;
import org.hl7.fhir.r4.model.Provenance;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.RelatedPerson;
import org.hl7.fhir.r4.model.StringType;

import ca.uhn.fhir.model.api.TemporalPrecisionEnum;
import gov.cdc.izgw.v2tofhir.annotation.ComesFrom;
import gov.cdc.izgw.v2tofhir.annotation.Produces;
import gov.cdc.izgw.v2tofhir.converter.MessageParser;
import gov.cdc.izgw.v2tofhir.utils.Codes;
import gov.cdc.izgw.v2tofhir.utils.FhirUtils;
import gov.cdc.izgw.v2tofhir.utils.ParserUtils;
import gov.cdc.izgw.v2tofhir.utils.RaceAndEthnicity;
import gov.cdc.izgw.v2tofhir.utils.Systems;
import lombok.extern.slf4j.Slf4j;

/**
 * PIDParser handles PID segments and creates Patient, Account and Related Person resources.  It works
 * with the PD1 parser to collect additional demographics, and the NK1 parser to collect
 * contact information.
 * 
 * @see &lt;a href=&quot;https://hl7.org/fhir/uv/v2mappings/2024Jan/ConceptMap-segment-pid-to-patient.html&quot;&gt;V2 to FHIR PID to Patient Mapping&lt;/a&gt;
 * @see &lt;a href=&quot;https://hl7.org/fhir/uv/v2mappings/2024Jan/ConceptMap-segment-pid-to-account.html&quot;&gt;V2 to FHIR PID to Account Mapping&lt;/a&gt;
 * 
 * @author Audacious Inquiry
 *
 */
@Produces(segment=&quot;PID&quot;, resource = Patient.class, extra = { RelatedPerson.class, Account.class })
<span class="fc" id="L54">@Slf4j</span>
public class PIDParser extends AbstractSegmentParser {
<span class="fc" id="L56">	private Patient patient = null;</span>
	static {
<span class="fc" id="L58">		log.debug(&quot;Loaded PIDParser&quot;);</span>
	}
	/** Extension for Patient mother's maiden name */
	public static final String MOTHERS_MAIDEN_NAME = &quot;http://hl7.org/fhir/StructureDefinition/patient-mothersMaidenName&quot;;
	/** Extension for OMB Category in US Core Race and Ethnicity Extensions */
	public static final String OMB_CATEGORY = &quot;ombCategory&quot;;
	/** Extension for Patient birth time */
	public static final String PATIENT_BIRTH_TIME = &quot;http://hl7.org/fhir/StructureDefinition/patient-birthTime&quot;;
	/** Extension for Patient birth place */
	public static final String PATIENT_BIRTH_PLACE = &quot;http://hl7.org/fhir/StructureDefinition/patient-birthPlace&quot;;
	/** Extension for Religion */
	private static final String RELIGION = &quot;http://hl7.org/fhir/StructureDefinition/patient-religion&quot;;
	/** Extension for Citizenship */
	public static final String PATIENT_CITIZENSHIP = &quot;http://hl7.org/fhir/StructureDefinition/patient-citizenship&quot;;
	/** Extension for Nationality */
	public static final String PATIENT_NATIONALITY = &quot;http://hl7.org/fhir/StructureDefinition/patient-nationality&quot;;
<span class="fc" id="L74">	private static List&lt;FieldHandler&gt; fieldHandlers = new ArrayList&lt;&gt;();</span>
	/**
	 * Create a PID parser for the specified message parser
	 * @param p The message parser to create this PID parser for
	 */
	public PIDParser(MessageParser p) {
<span class="fc" id="L80">		super(p, &quot;PID&quot;);</span>
<span class="fc bfc" id="L81" title="All 2 branches covered.">		if (fieldHandlers.isEmpty()) {</span>
<span class="fc" id="L82">			FieldHandler.initFieldHandlers(this, fieldHandlers);</span>
		}
<span class="fc" id="L84">	}</span>
	
	@Override
	public List&lt;FieldHandler&gt; getFieldHandlers() {
<span class="fc" id="L88">		return fieldHandlers;</span>
	}

	@Override 
	public IBaseResource setup() {
<span class="fc" id="L93">		patient = this.createResource(Patient.class);</span>
		
<span class="fc" id="L95">		MessageHeader mh = getFirstResource(MessageHeader.class);</span>
<span class="fc bfc" id="L96" title="All 2 branches covered.">		if (mh != null) {</span>
<span class="fc" id="L97">			Reference ref = ParserUtils.toReference(patient, mh, &quot;focus&quot;);</span>
<span class="fc" id="L98">			mh.addFocus(ref);</span>
		}

<span class="fc" id="L101">		return patient;</span>
	}
	
	/**
	 * Add an identifier to the patient
	 * @param ident	The identifier to add
	 */
	@ComesFrom(path=&quot;Patient.identifier&quot;, field = 2)
	@ComesFrom(path=&quot;Patient.identifier&quot;, field = 3)
	@ComesFrom(path=&quot;Patient.identifier&quot;, field = 4)
	@ComesFrom(path=&quot;Patient.identifier&quot;, field = 20, comment = &quot;Driver's License Number&quot;)

	public void addIdentifier(Identifier ident) {
<span class="fc" id="L114">		patient.addIdentifier(ident);</span>
<span class="fc" id="L115">	}</span>
	
	/**
	 * Add a name to the patient
	 * @param name	The name to add
	 */
	@ComesFrom(path=&quot;Patient.name&quot;, field = 5)
	public void addName(HumanName name) {
<span class="fc" id="L123">		patient.addName(name);</span>
<span class="fc" id="L124">	}</span>
	/**
	 * Add a mothers maiden name to a patient using the mothersMaidenName extension.
	 * 
	 * @param hn	The mother's maiden name
	 */
	@ComesFrom(path=&quot;Patient.patient-mothersMaidenName.valueString&quot;, field = 6, fhir = HumanName.class)
	public void addMothersMaidenName(HumanName hn) {
<span class="pc bpc" id="L132" title="2 of 4 branches missed.">		if (!FhirUtils.isEmpty(hn) &amp;&amp; hn.hasFamily()) {</span>
<span class="fc" id="L133">			patient.addExtension()</span>
<span class="fc" id="L134">				.setUrl(MOTHERS_MAIDEN_NAME)</span>
<span class="fc" id="L135">				.setValue(hn.getFamilyElement());</span>
		}
<span class="fc" id="L137">	}</span>
	
	/**
	 * Add a birth date and optionally the time of birth to a patient.
	 * 
	 * If the precision of the datetime is greater than to the day, a birthTime extension
	 * will be added to the patient.birthDate element.
	 * 
	 * @param dt	The datetime
	 */
	@ComesFrom(path=&quot;Patient.birthDate&quot;, field = 7, fhir = DateTimeType.class,
			   also=&quot;Patient.patient-birthTime&quot;)
	public void addBirthDateTime(DateTimeType dt) {
<span class="pc bpc" id="L150" title="1 of 2 branches missed.">		if (!FhirUtils.isEmpty(dt)) {</span>
<span class="fc" id="L151">			patient.setBirthDate(dt.getValue());</span>
<span class="pc bpc" id="L152" title="1 of 2 branches missed.">			if (dt.getPrecision().compareTo(TemporalPrecisionEnum.DAY) &gt; 0) {</span>
<span class="nc" id="L153">				patient.getBirthDateElement().addExtension()</span>
<span class="nc" id="L154">					.setUrl(PATIENT_BIRTH_TIME)</span>
<span class="nc" id="L155">					.setValue(dt);</span>
			}
		}
<span class="fc" id="L158">	}</span>

	/**
	 * Set a gender on a patient based on a Codeable Concept
	 * @param gender	A Codeable Concept representing the patient gender
	 */
	@ComesFrom(
		path=&quot;Patient.gender&quot;, field = 8, table=&quot;0001&quot;, 
		map = &quot;Gender&quot;, 
		fhir = CodeableConcept.class
	)
	public void setGender(CodeableConcept gender) {
<span class="pc bpc" id="L170" title="1 of 2 branches missed.">		for (Coding coding: gender.getCoding()) {</span>
<span class="pc bpc" id="L171" title="2 of 4 branches missed.">			if (coding.hasCode() &amp;&amp; coding.hasSystem()) {</span>
<span class="fc" id="L172">				String system = coding.getSystem();</span>
<span class="pc bpc" id="L173" title="1 of 2 branches missed.">				if (system.endsWith(&quot;0001&quot;)) {</span>
<span class="fc" id="L174">					setGenderFromTable0001(patient.getGenderElement(), coding);</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">				} else if (Systems.getSystemNames(system).contains(Systems.DATA_ABSENT)) {</span>
<span class="nc" id="L176">					setDataAbsentReasonFromDataAbsent(patient.getGenderElement(), coding.getCode());</span>
<span class="nc bnc" id="L177" title="All 2 branches missed.">				} else if (Systems.getSystemNames(system).contains(Systems.NULL_FLAVOR)) {</span>
<span class="nc" id="L178">					setDataAbsentFromNullFlavor(patient.getGenderElement(), coding.getCode());</span>
				}
			}
<span class="pc bpc" id="L181" title="1 of 2 branches missed.">			if (patient.hasGender()) { break; }</span>
<span class="nc" id="L182">		}</span>
<span class="fc" id="L183">	}</span>

	/**
	 * Set gender from HL7 Table 0001
	 * @param enumeration	The enumeration to set the value for 
	 * @param gender	The gender code
	 */
	public static void setGenderFromTable0001(Enumeration&lt;AdministrativeGender&gt; enumeration, Coding gender) {
<span class="pc bpc" id="L191" title="7 of 9 branches missed.">		switch (gender.getCode()) {</span>
<span class="nc" id="L192">		case &quot;A&quot;:	enumeration.setValue(AdministrativeGender.OTHER); break;</span>
<span class="fc" id="L193">		case &quot;F&quot;:	enumeration.setValue(AdministrativeGender.FEMALE); break;</span>
<span class="fc" id="L194">		case &quot;M&quot;:	enumeration.setValue(AdministrativeGender.MALE); break;</span>
<span class="nc" id="L195">		case &quot;N&quot;:	FhirUtils.setDataAbsentReason(enumeration, &quot;not-applicable&quot;); break;</span>
<span class="nc" id="L196">		case &quot;O&quot;:	enumeration.setValue(AdministrativeGender.OTHER); break;</span>
		case &quot;U&quot;, &quot;UNK&quot;:
<span class="nc" id="L198">					enumeration.setValue(AdministrativeGender.UNKNOWN); break;</span>
		case &quot;ASKU&quot;:
<span class="nc" id="L200">					FhirUtils.setDataAbsentReason(enumeration, &quot;asked-unknown&quot;); break;</span>
		case &quot;PHC1175&quot;:
<span class="nc" id="L202">					FhirUtils.setDataAbsentReason(enumeration, &quot;asked-declined&quot;); break;</span>
<span class="nc" id="L203">		default:	FhirUtils.setDataAbsent(enumeration); break;</span>
		}
<span class="fc" id="L205">	}</span>
	
	/**
	 * Set the reason why gender is not present from a code in DataAbsentReason
	 * @param gender	The gender value to update
	 * @param code		A code from DataAbsentReason
	 */
	public void setDataAbsentReasonFromDataAbsent(Enumeration&lt;AdministrativeGender&gt; gender, String code) {
<span class="nc bnc" id="L213" title="All 4 branches missed.">		switch (code) {</span>
<span class="nc" id="L214">		case &quot;unsupported&quot;: gender.setValue(AdministrativeGender.OTHER); break;</span>
<span class="nc" id="L215">		case &quot;unknown&quot;: 	gender.setValue(AdministrativeGender.UNKNOWN); break;</span>
<span class="nc" id="L216">		case &quot;temp-unknown&quot;:gender.setValue(AdministrativeGender.UNKNOWN); break;</span>
<span class="nc" id="L217">		default:			FhirUtils.setDataAbsentReason(gender, code); break;</span>
		}
<span class="nc" id="L219">	}</span>

	/**
	 * Set the reason why gender is not present from a code in NulLFlavor
	 * @param gender	The gender value to update
	 * @param code		A code from NullFlavor
	 */
	public void setDataAbsentFromNullFlavor(Enumeration&lt;AdministrativeGender&gt; gender, String code) {
<span class="nc bnc" id="L227" title="All 4 branches missed.">		switch (code) {</span>
<span class="nc" id="L228">		case &quot;OTH&quot;: gender.setValue(AdministrativeGender.OTHER); break;</span>
<span class="nc" id="L229">		case &quot;UNK&quot;: gender.setValue(AdministrativeGender.UNKNOWN); break;</span>
<span class="nc" id="L230">		case &quot;NAVU&quot;:gender.setValue(AdministrativeGender.UNKNOWN); break;</span>
<span class="nc" id="L231">		default:	setDataAbsentFromNullFlavor(gender, code); break;</span>
		}
<span class="nc" id="L233">	}</span>
	
	/**
	 * Add an alias to the list of patient names.
	 * @param alias	The alias
	 */
	@ComesFrom(path=&quot;Patient.name&quot;, field = 9)
	public void addAlias(HumanName alias) {
<span class="nc bnc" id="L241" title="All 2 branches missed.">		if (!FhirUtils.isEmpty(alias)) {</span>
			// Aliases are NOT official names.
<span class="nc bnc" id="L243" title="All 2 branches missed.">			if (!alias.hasUse()) { alias.setUse(NameUse.USUAL); }</span>
<span class="nc" id="L244">			patient.addName(alias);</span>
		}
<span class="nc" id="L246">	}</span>

	/**
	 * Add a race code to the patient using the US Core Race extension
	 * @param race	The race to add.
	 */
	@ComesFrom(path=&quot;Patient.us-core-race.extension('ombCategory').valueCoding&quot;, table = &quot;0005&quot;, map = &quot;USCoreRace&quot;, field = 10,
				also= {
					&quot;Patient.us-core-race.extension('ombDetail').valueCoding&quot;,
					&quot;Patient.us-core-race.extension('text').valueString&quot;
				}
	)
	public void addRace(CodeableConcept race) {
<span class="pc bpc" id="L259" title="1 of 2 branches missed.">		if (FhirUtils.isEmpty(race)) {</span>
<span class="nc" id="L260">			return;</span>
		}
		
<span class="fc" id="L263">		Extension raceExtension = patient.addExtension().setUrl(RaceAndEthnicity.US_CORE_RACE);</span>
<span class="fc" id="L264">		getParser().getContext().setProperty(raceExtension.getUrl(), raceExtension);</span>
<span class="fc" id="L265">		RaceAndEthnicity.setRaceCode(race, raceExtension);</span>
		
<span class="fc" id="L267">	}</span>

	/**
	 * Add an address to the patient
	 * @param address The address
	 */
	@ComesFrom(path=&quot;Patient.address&quot;, field = 11)
	public void addAddress(Address address) {
<span class="fc" id="L275">		patient.addAddress(address);</span>
<span class="fc" id="L276">	}</span>
	
	/**
	 * Add the county name to the patient address
	 * @param countyName The name of the county
	 */
	
	@ComesFrom(path=&quot;Patient.address.district&quot;, field = 12)
	public void addCounty(StringType countyName) {
<span class="nc bnc" id="L285" title="All 2 branches missed.">		if (patient.hasAddress()) {</span>
<span class="nc bnc" id="L286" title="All 2 branches missed.">			if (!patient.getAddressFirstRep().hasDistrict()) {</span>
				// Set county on first address
<span class="nc" id="L288">				patient.getAddressFirstRep().setDistrictElement(countyName);</span>
<span class="nc bnc" id="L289" title="All 2 branches missed.">			} else if (!patient.getAddressFirstRep().getDistrict().equals(countyName.getValue()) ) {</span>
				// The county doesn't match district of first address, add a new address containing only the county
<span class="nc" id="L291">				patient.addAddress().setDistrictElement(countyName);</span>
			} else {
				// They match so we can ignore this case.
			}
		}
<span class="nc" id="L296">	}</span>
	
	/**
	 * Add an ethnicity code to the patient using the US Core Ethnicity extension
	 * @param ethnicity	The ethnicity to add.
	 */
	@ComesFrom(path=&quot;Patient.us-core-ethnicity.extension('ombCategory').valueCoding&quot;, table = &quot;0189&quot;, map = &quot;USCoreEthnicity&quot;, field = 22,
			also = {
				&quot;Patient.us-core-ethnicity.extension('ombDetail').valueCoding&quot;,
				&quot;Patient.us-core-ethnicity.extension('text').valueString&quot;
			}
	)
	public void addEthnicity(CodeableConcept ethnicity) {
<span class="pc bpc" id="L309" title="1 of 2 branches missed.">		if (FhirUtils.isEmpty(ethnicity)) {</span>
<span class="nc" id="L310">			return;</span>
		}
		
<span class="fc" id="L313">		Extension ethnicityExtension = patient.addExtension().setUrl(RaceAndEthnicity.US_CORE_ETHNICITY);</span>
<span class="fc" id="L314">		getParser().getContext().setProperty(ethnicityExtension.getUrl(), ethnicityExtension);</span>
<span class="fc" id="L315">		RaceAndEthnicity.setEthnicityCode(ethnicity, ethnicityExtension);</span>

<span class="fc" id="L317">	}</span>

	/**
	 * Add a phone number to a patient
	 * @param phone	The phone number (or other telecommuncations address)
	 * @param use	The use if unspecified
	 */
	public void addPhone(ContactPoint phone, ContactPointUse use) {
<span class="pc bpc" id="L325" title="1 of 4 branches missed.">		if (!phone.hasUse() &amp;&amp; use != null) {</span>
<span class="fc" id="L326">			phone.setUse(use);</span>
		}
<span class="fc" id="L328">		patient.addTelecom(phone);</span>
<span class="fc" id="L329">	}</span>
	
	/**
	 * Add a Home contact point to the patient
	 * @param homePhone The contact point
	 */
	@ComesFrom(path=&quot;Patient.telecom&quot;, field = 13, comment = &quot;Home Phone&quot;)
	public void addHomePhone(ContactPoint homePhone) {
<span class="fc" id="L337">		addPhone(homePhone, ContactPointUse.HOME);</span>
<span class="fc" id="L338">	}</span>
	/**
	 * Add a Work contact point to the patient
	 * @param workPhone		The contact point
	 */
	@ComesFrom(path=&quot;Patient.telecom&quot;, field = 14, comment = &quot;Work Phone&quot;)
	public void addWorkPhone(ContactPoint workPhone) {
<span class="nc" id="L345">		addPhone(workPhone, ContactPointUse.WORK);</span>
<span class="nc" id="L346">	}</span>
	
	/**
	 * Add a contact point to the patient
	 * @param telecom The contact point
	 */
	@ComesFrom(path=&quot;Patient.telecom&quot;, field = 40, comment=&quot;Patient Telecommunication Information&quot;)
	public void addTelecom(ContactPoint telecom) {
<span class="nc" id="L354">		addPhone(telecom, null);</span>
<span class="nc" id="L355">	}</span>

	
	/**
	 * Add a language for the patient.
	 * @param language The language
	 */
	@ComesFrom(path=&quot;Patient.communication.language&quot;, field = 15)
	public void addLanguage(CodeableConcept language) {
<span class="nc" id="L364">		patient.addCommunication().setLanguage(language);</span>
<span class="nc" id="L365">	}</span>

	
	/**
	 * Set the marital status for the patient.
	 * @param maritalStatus	The marital status
	 */
	@ComesFrom(path=&quot;Patient.maritalStatus&quot;, field = 16)
	public void setMaritalStatus(CodeableConcept maritalStatus) {
<span class="nc" id="L374">		patient.setMaritalStatus(maritalStatus);</span>
<span class="nc" id="L375">	}</span>
	
	/**
	 * Add a religion to the patient
	 * @param religion	The religion
	 */
	@ComesFrom(path=&quot;Patient.patient-religion&quot;, field = 17)
	public void addReligion(CodeableConcept religion) {
<span class="nc" id="L383">		patient.addExtension(RELIGION, religion);</span>
<span class="nc" id="L384">	}</span>
	
	/**
	 * Add a patient account
	 * 
	 * Creates a new active account resource with the specified identifier, and ties it back to the 
	 * patient via a reference.
	 *  
	 * @param accountId	The account identifier
	 */
	@ComesFrom(path=&quot;Account.identifier&quot;, field = 18, comment = &quot;Patient Account&quot;)
	public void addAccount(Identifier accountId) {
<span class="nc bnc" id="L396" title="All 2 branches missed.">		if (FhirUtils.isEmpty(accountId)) {</span>
<span class="nc" id="L397">			return;</span>
		}
<span class="nc" id="L399">		Account account = createResource(Account.class);</span>
<span class="nc" id="L400">		account.addIdentifier(accountId);</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">		if (!FhirUtils.isEmpty(patient)) {</span>
<span class="nc" id="L402">			account.setStatus(AccountStatus.ACTIVE);</span>
<span class="nc" id="L403">			account.addSubject(ParserUtils.toReference(patient, account, &quot;patient&quot;, &quot;subject&quot;));</span>
		}
<span class="nc" id="L405">	}</span>

	/**
	 * Add a social security number to a patient.
	 * @param ssn	The social security number
	 */
	@ComesFrom(path=&quot;Patient.identifier&quot;, field = 19, comment = &quot;Social Security Number&quot;)
	public void addSSN(Identifier ssn) {
<span class="nc bnc" id="L413" title="All 4 branches missed.">		if (FhirUtils.isEmpty(patient) || FhirUtils.isEmpty(ssn)) {</span>
<span class="nc" id="L414">			return;</span>
		}
<span class="nc bnc" id="L416" title="All 2 branches missed.">		if (!ssn.hasType()) {</span>
<span class="nc" id="L417">			ssn.setType(Codes.SSN_TYPE);</span>
		}
<span class="nc bnc" id="L419" title="All 2 branches missed.">		if (!ssn.hasSystem()) {</span>
<span class="nc" id="L420">			ssn.setSystem(Systems.SSN);</span>
		}
<span class="nc" id="L422">		patient.addIdentifier(ssn);</span>
<span class="nc" id="L423">	}</span>
	
	/**
	 * Add the mothers identifier to a RelatedPerson for this patient.
	 * @param mother	The mother's identifier
	 */
	@ComesFrom(path=&quot;RelatedPerson.identifier&quot;, field = 21, comment=&quot;Mother's identifier&quot;)
	public void addMother(Identifier mother) {
<span class="nc bnc" id="L431" title="All 4 branches missed.">		if (FhirUtils.isEmpty(patient) || FhirUtils.isEmpty(mother)) {</span>
<span class="nc" id="L432">			return;</span>
		}
<span class="nc" id="L434">		RelatedPerson rp = (RelatedPerson) patient.getUserData(&quot;mother&quot;);</span>
<span class="nc bnc" id="L435" title="All 2 branches missed.">		if (rp == null) {</span>
<span class="nc" id="L436">			rp = createResource(RelatedPerson.class);</span>
<span class="nc" id="L437">			patient.setUserData(&quot;mother&quot;, rp);</span>
		}
<span class="nc" id="L439">		rp.addIdentifier(mother);</span>
<span class="nc" id="L440">		rp.setPatient(ParserUtils.toReference(patient, rp, &quot;patient&quot;));</span>
<span class="nc" id="L441">		rp.addRelationship(Codes.MOTHER);</span>
<span class="nc" id="L442">	}</span>
	
	/**
	 * Add the patient's birth place
	 * @param birthPlace	The birthplace
	 */
	@ComesFrom(path=&quot;Patient.patient-birthPlace&quot;, field = 23)
	public void addBirthPlace(StringType birthPlace) {
<span class="nc bnc" id="L450" title="All 4 branches missed.">		if (FhirUtils.isEmpty(patient) || FhirUtils.isEmpty(birthPlace)) {</span>
<span class="nc" id="L451">			return;</span>
		}
<span class="nc" id="L453">		patient.addExtension(PATIENT_BIRTH_PLACE, birthPlace);</span>
<span class="nc" id="L454">	}</span>

	/**
	 * Add the patient's multiple birth indicator
	 * @param indicator	The indicator
	 */
	@ComesFrom(path=&quot;Patient.multipleBirthBoolean&quot;, field = 24, comment=&quot;Multiple Birth Indicator&quot;)
	public void setMultipleBirthIndicator(BooleanType indicator) {
<span class="nc" id="L462">		patient.setMultipleBirth(indicator);</span>
<span class="nc" id="L463">	}</span>
	
	/**
	 * Add the patient's multiple birth order
	 * @param order		The birth order
	 */
	@ComesFrom(path=&quot;Patient.multipleBirthInteger&quot;, field = 25, comment=&quot;Multiple Birth Order&quot;)
	public void setMultipleBirthOrder(IntegerType order) {
<span class="nc" id="L471">		patient.setMultipleBirth(order);</span>
<span class="nc" id="L472">	}</span>
	
	/**
	 * Add the patient's citizenship
	 * @param cc	The citizenship
	 */
	@ComesFrom(path=&quot;Patient.patient-citizenship&quot;, field = 26, comment=&quot;Citizenship&quot;)
	@ComesFrom(path=&quot;Patient.patient-citizenship&quot;, field = 39, comment=&quot;Tribal Citizenship&quot;)
	public void addCitizenship(CodeableConcept cc) {
<span class="nc" id="L481">		patient.addExtension(PATIENT_CITIZENSHIP, new Extension(&quot;code&quot;, cc));</span>
<span class="nc" id="L482">	}</span>
	/**
	 * Add the patient's nationality
	 * @param cc	The nationality
	 */
	@ComesFrom(path=&quot;Patient.patient-nationality&quot;, field = 28, comment=&quot;Nationality&quot;)
	public void addNationality(CodeableConcept cc) {
<span class="nc" id="L489">		patient.addExtension(PATIENT_NATIONALITY, new Extension(&quot;code&quot;, cc));</span>
<span class="nc" id="L490">	}</span>

	/**
	 * Add the patient's deceased indicator
	 * @param indicator	The indicator
	 */
	@ComesFrom(path=&quot;Patient.deceasedBoolean&quot;, field = 30, comment=&quot;Deceased Indicator&quot;)
	public void setDeceasedIndicator(BooleanType indicator) {
<span class="nc" id="L498">		patient.setDeceased(indicator);</span>
<span class="nc" id="L499">	}</span>
	
	/**
	 * Add the patient's deceased date
	 * @param dateTime	The datetime
	 */
	@ComesFrom(path=&quot;Patient.deceasedDateTime&quot;, field = 29, comment=&quot;Deceased Date Time&quot;)
	public void setDeceasedDateTime(DateTimeType dateTime) {
<span class="nc" id="L507">		patient.setDeceased(dateTime);</span>
<span class="nc" id="L508">	}</span>
	/**
	 * Set the patient's last updated tyime
	 * @param instant	The last updated time
	 */
	@ComesFrom(path=&quot;Patient.meta.lastUpdated&quot;, field = 33)
	public void setLastUpdated(InstantType instant) {
<span class="nc" id="L515">		patient.getMeta().setLastUpdatedElement(instant);</span>
<span class="nc" id="L516">	}</span>
	/**
	 * Add the last updated facility and date time to provenance information
	 * @param ident	The last updated facility identifier
	 */
	public void addLastUpdatedFacility(Identifier ident) {
<span class="nc" id="L522">		Provenance p = (Provenance) patient.getUserData(Provenance.class.getName());</span>
<span class="nc bnc" id="L523" title="All 2 branches missed.">		if (p == null) {</span>
<span class="nc" id="L524">			return;</span>
		}
		// TODO: Figure this out
<span class="nc" id="L527">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>